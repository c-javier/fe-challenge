(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{24:function(e,t,n){e.exports=n(38)},33:function(e,t,n){},38:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(19),c=n.n(r),i=n(13),s=n(8),l=n(21),u=n.n(l),p=n(22),d=n(7),f=Object(s.c)({service_roles:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH_CATEGORIES_SUCCESS":return Object(d.a)({},e,{categories:t.payload});case"FETCH_CATEGORIES_FAILURE":return Object(d.a)({},e,{error:t.payload});default:return e}},list_of_pros:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH_PROS_IN_PROGRESS":return Object(d.a)({},e,{pros:t.payload});case"FETCH_PROS_TOTAL_COUNT_SUCCESS":return Object(d.a)({},e,{totalProsCount:t.payload});case"FETCH_PROS_SUCCESS":return Object(d.a)({},e,{pros:t.payload.response.pros});case"FETCH_PROS_FAILURE":return Object(d.a)({},e,{error:t.payload});default:return e}}});n(33);var h=n(16),v=n.n(h),g=n(23),m=n(2),b=n(3),O=n(6),y=n(4),E=n(5),C=n(11),j=n(1),S=function(){return{type:"FETCH_CATEGORIES_IN_PROGRESS"}},P=function(e){return{type:"FETCH_CATEGORIES_SUCCESS",payload:e}},_=function(e){return{type:"FETCH_CATEGORIES_FAILURE",payload:e}},k=function(){return{type:"FETCH_PROS_IN_PROGRESS",payload:[]}},w=function(e){return{type:"FETCH_PROS_SUCCESS",payload:e}},T=function(e){return{type:"FETCH_PROS_FAILURE",payload:e}},R=function(e){return{type:"FETCH_PROS_TOTAL_COUNT_SUCCESS",payload:e}},F=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(O.a)(this,Object(y.a)(t).call(this,e))).onCategorySelectionChange=function(e){e.preventDefault();var t=Object(j.find)(e.target.options,"selected"),a=t.text,o=t.value;n.setState({categoryName:a,value:o}),n.props.onUpdateCategory(a,o)},n.renderOption=function(e,t){return 0===t?o.a.createElement("option",{key:t,value:n.state.value},n.state.categoryName):e.hidden?void 0:o.a.createElement("option",{key:t,value:e.id},e.name)},n.state={categoryName:"Select a category",value:""},n}return Object(E.a)(t,e),Object(b.a)(t,[{key:"render",value:function(){var e=this.props.categories.map(this.renderOption);return o.a.createElement("label",null,"Category:",o.a.createElement("select",{onChange:this.onCategorySelectionChange,value:this.state.value},e))}}]),t}(a.Component),N=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(O.a)(this,Object(y.a)(t).call(this,e))).onPostalCodeUpdate=function(e){e.preventDefault();var t=e.target.value;n.setState({value:t}),n.props.onUpdatePostCode(t)},n.state={value:""},n}return Object(E.a)(t,e),Object(b.a)(t,[{key:"render",value:function(){return o.a.createElement("label",null,"Postcode:",o.a.createElement("input",{value:this.state.value,onChange:this.onPostalCodeUpdate}))}}]),t}(a.Component),U=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(O.a)(this,Object(y.a)(t).call(this,e))).onClick=function(){var e=n.state,t=e.category,a=e.postcode;n.props.fetchPros(t.value,a,0)},n.onUpdateCategory=function(e,t){n.setState({category:{name:e,value:t}})},n.onUpdatePostCode=function(e){n.setState({postcode:e})},n.state={category:{name:"",value:""},postcode:""},n}return Object(E.a)(t,e),Object(b.a)(t,[{key:"render",value:function(){return o.a.createElement("div",{className:"pros-filter"},o.a.createElement(F,{categories:this.props.categories,onUpdateCategory:this.onUpdateCategory}),o.a.createElement(N,{onUpdatePostCode:this.onUpdatePostCode}),o.a.createElement("button",{onClick:this.onClick},"Submit"))}}]),t}(a.Component),A=["Id","Name","Postcode","Review Rating"],I=function(e){function t(){var e,n;Object(m.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(O.a)(this,(e=Object(y.a)(t)).call.apply(e,[this].concat(r)))).getStarRating=function(e){var t=Object(j.times)(e,function(t){return o.a.createElement("section",{className:"star-rating black-star",key:e+t},"\u2605")}),n=Object(j.times)(5-e,function(t){return o.a.createElement("section",{className:"star-rating",key:5-e+t},"\u2606")});return t.concat(n)},n.renderTableHeaders=function(){return A.map(function(e,t){return o.a.createElement("td",{className:"table-header",key:t},e)})},n.renderPros=function(){return n.props.listOfPros.map(function(e,t){var a=e.id,r=e.name,c=e.main_address,i=e.review_rating,s=n.getStarRating(i);return o.a.createElement("tr",{className:t%2?void 0:"pro-tr-grey",key:t+1},o.a.createElement("td",{className:"pro-td",key:"".concat(t+2)},a),o.a.createElement("td",{className:"pro-td",key:"".concat(t+3)},r),o.a.createElement("td",{className:"pro-td",key:"".concat(t+4)},c.postcode),o.a.createElement("td",{className:"pro-td",key:"".concat(t+5)},s))})},n}return Object(E.a)(t,e),Object(b.a)(t,[{key:"render",value:function(){return o.a.createElement("table",null,o.a.createElement("tbody",null,o.a.createElement("tr",null,this.renderTableHeaders()),this.renderPros()))}}]),t}(a.Component),H=function(e){return Math.ceil(Object(j.toNumber)(e)/20)},L=function(e){function t(){var e,n;Object(m.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(O.a)(this,(e=Object(y.a)(t)).call.apply(e,[this].concat(r)))).generatePaginationLinks=function(){var e=n.props,t=e.onFetchPros,a=e.categoryId,r=e.postcode,c=e.totalProsCount,i=H(c);return Object(j.times)(i,function(e){return o.a.createElement("button",{key:e,onClick:function(){return t(a,r,e)}},e+1)})},n}return Object(E.a)(t,e),Object(b.a)(t,[{key:"render",value:function(){var e=this.props,t=e.onFetchPros,n=e.categoryId,a=e.postcode,r=e.totalProsCount,c=H(r),i=c<20?0:c;return o.a.createElement("div",{className:"pagination"},o.a.createElement("button",{onClick:function(){return t(n,a,0)}},"\xab"),this.generatePaginationLinks(),o.a.createElement("button",{onClick:function(){return t(n,a,i)}},"\xbb"))}}]),t}(a.Component),G=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(O.a)(this,Object(y.a)(t).call(this,e))).state={category:{value:""},postcode:""},n.onFetchPros=n.onFetchPros.bind(Object(C.a)(Object(C.a)(n))),n}return Object(E.a)(t,e),Object(b.a)(t,[{key:"componentDidMount",value:function(){this.props.fetchCategories()}},{key:"onFetchPros",value:function(){var e=Object(g.a)(v.a.mark(function e(t,n,a){var o,r,c;return v.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=this.props,r=o.fetchPros,c=o.listOfPros,e.next=3,r(t,n,a);case 3:this.setState({category:{value:t},postcode:n,listOfPros:c});case 4:case"end":return e.stop()}},e,this)}));return function(t,n,a){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.props,t=e.list_of_pros,n=e.service_roles,a=this.state,r=a.category,c=a.postcode;return o.a.createElement("div",{className:"App"},o.a.createElement("header",null,o.a.createElement("p",null,"Your site")),o.a.createElement("hr",null),n.categories&&o.a.createElement(U,{categories:n.categories,fetchPros:this.onFetchPros}),o.a.createElement("hr",null),t.pros&&o.a.createElement(I,{listOfPros:Object(j.isEmpty)(t.pros)?[]:t.pros}),t.totalProsCount&&o.a.createElement(L,{onFetchPros:this.onFetchPros,categoryId:r.value,postcode:c,totalProsCount:t.totalProsCount}))}}]),t}(a.Component),x=Object(i.b)(function(e){return Object(d.a)({},e)},function(e){return{fetchCategories:function(){return e(function(e){e(S()),fetch("https://d1i9eedhsgvpdh.cloudfront.net/production-plentific-static/api-cache/find-a-pro/api/v1/categories/all.json",{method:"GET"}).then(function(e){return e.json()}).then(function(t){return e(P(t))}).catch(function(t){return e(_(t))})})},fetchPros:function(t,n,a){return e(function(e,t,n){return function(a){var o={category_id:Object(j.toNumber)(e),location:Object(j.toLower)(t)},r={method:"POST",headers:{"Content-Type":"application/json","x-pagination-offset":Object(j.toString)(n),"x-pagination-limit":"20"},body:JSON.stringify(o)};a(k()),fetch("https://demo.plentific.com/find-a-pro/api/v2/public/pro/search-pros/",r).then(function(e){return a(R(e.headers.get("x-pagination-count"))),e.json()}).then(function(e){return a(w(e))}).catch(function(e){return a(T(e))})}}(t,n,a))}}})(G),W=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function D(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See http://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}c.a.render(o.a.createElement(i.a,{store:Object(s.e)(f,Object(s.d)(Object(s.a)(p.a),Object(s.a)(u.a)))},o.a.createElement(x,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/fe-challenge",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("/fe-challenge","/service-worker.js");W?(function(e,t){fetch(e).then(function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):D(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit http://bit.ly/CRA-PWA")})):D(t,e)})}}()}},[[24,2,1]]]);
//# sourceMappingURL=main.d05262b6.chunk.js.map